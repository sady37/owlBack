# ChatGPT 代码审查提示词

> **目的**: 提供标准化的提示词，确保 ChatGPT 能够准确审查代码

---

## 📋 标准提示词模板

### 模板 1: 全面审查

```
请审查以下 Go 代码，重点关注以下方面：

## 1. 代码质量
- 命名是否清晰、符合 Go 规范？
- 函数是否过长（建议 < 50 行）？
- 是否有重复代码？
- 代码结构是否清晰？

## 2. 潜在错误
- 是否有逻辑错误？
- 是否有边界条件未处理？
- 是否有空指针风险？
- 是否有数组越界风险？

## 3. 性能问题
- 是否有 N+1 查询问题？
- 是否有不必要的循环？
- 是否有内存泄漏风险？
- 是否有不必要的内存分配？

## 4. 并发安全
- 是否有数据竞争？
- 是否需要加锁？
- Context 使用是否正确？

## 5. 错误处理
- 所有错误是否都被处理？
- 错误信息是否有意义？
- 是否使用了 %w 包装错误？

## 6. 最佳实践
- 是否符合 Go 代码规范？
- 是否使用了合适的 Go 特性？
- 是否有更好的实现方式？

## 7. 安全性
- 是否有 SQL 注入风险？
- 是否有输入验证？
- 敏感信息是否泄露？

请提供：
1. 发现的问题列表（按严重性排序）
2. 具体的改进建议
3. 代码质量评分（1-10 分）

[粘贴代码]
```

---

### 模板 2: 特定问题审查

```
请审查以下 Go 代码，特别关注 [特定问题]：

[特定问题]：
- 问题 1: N+1 查询问题
- 问题 2: 并发安全问题
- 问题 3: 性能优化

请：
1. 找出所有相关的问题
2. 提供具体的修复建议
3. 提供修复后的代码示例

[粘贴代码]
```

---

### 模板 3: 架构审查

```
请审查以下 Go 服务的架构设计：

服务名称: [服务名]
主要功能: [功能描述]

请评估：
1. 架构设计是否合理？
2. 分层是否清晰？
3. 职责划分是否明确？
4. 是否有设计模式可以应用？
5. 是否有更好的架构方案？

[粘贴架构说明和关键代码]
```

---

## 🎯 针对 OwlBack 的特定提示词

### 提示词 1: 传感器融合逻辑审查

```
请审查以下 Go 代码，这是传感器融合服务的核心逻辑：

## 上下文
- 服务名称: wisefido-sensor-fusion
- 功能: 融合多个设备（Sleepace + Radar）的数据
- 融合规则: HR/RR 优先 Sleepace，姿态合并所有 Radar

## 审查重点
1. 融合逻辑是否正确实现了优先级规则？
2. 是否有性能问题（N+1 查询）？
3. 错误处理是否完善？
4. 是否有并发安全问题？
5. 代码是否清晰易懂？

[粘贴 sensor_fusion.go 代码]
```

---

### 提示词 2: SQL 查询审查

```
请审查以下 Go 代码中的 SQL 查询：

## 上下文
- 数据库: PostgreSQL
- 查询目的: 根据设备ID查询关联的卡片

## 审查重点
1. SQL 查询是否正确？
2. 是否有性能问题？
3. 是否有 SQL 注入风险？
4. 是否可以优化？

[粘贴 SQL 查询代码]
```

---

### 提示词 3: 数据转换逻辑审查

```
请审查以下 Go 代码，这是数据转换服务的核心逻辑：

## 上下文
- 服务名称: wisefido-data-transformer
- 功能: 将原始设备数据转换为标准化格式
- 转换内容: SNOMED CT 映射、FHIR Category 分类

## 审查重点
1. 转换逻辑是否正确？
2. SNOMED 映射是否准确？
3. 数据验证是否完善？
4. 错误处理是否合理？

[粘贴 transformer 代码]
```

---

## 📊 审查结果记录模板

### ChatGPT 审查结果

**审查日期**: _______________

**审查文件**: _______________

**发现的问题**:

1. **问题描述**: _______________
   - **位置**: _______________
   - **严重性**: 高/中/低
   - **建议**: _______________

2. **问题描述**: _______________
   - **位置**: _______________
   - **严重性**: 高/中/低
   - **建议**: _______________

**代码质量评分**: _______________ / 10

**与 Claude 审查的差异**:
- 发现的新问题: _______________
- 不同观点: _______________

---

## 🔄 对比分析

### Claude vs ChatGPT

| 问题 | Claude 发现 | ChatGPT 发现 | 差异 |
|------|------------|-------------|------|
| N+1 查询 | ✅ | ⬜ | _______________ |
| 时间戳比较 | ✅ | ⬜ | _______________ |
| 并发安全 | ⚠️ | ⬜ | _______________ |

---

## ✅ 使用建议

1. **准备代码**: 确保代码格式正确，有详细注释
2. **选择提示词**: 根据审查目标选择合适的模板
3. **记录结果**: 使用模板记录审查结果
4. **对比分析**: 对比不同 AI 的审查结果
5. **修复问题**: 根据审查结果修复问题

---

**最后更新**: 2024-12-19

