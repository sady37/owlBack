# 启用 wisefido-data Doctor 功能

## 快速启动

### 1. 启动所有服务（包括 wisefido-data）

```bash
cd /Users/sady3721/project/owlBack
docker-compose up -d
```

### 2. 查看服务状态

```bash
docker-compose ps
```

### 3. 查看日志确认 Doctor 已启用

```bash
docker-compose logs wisefido-data | grep -i doctor
```

应该能看到类似这样的日志：
```
Doctor (diagnostic) enabled pprof=false
```

## 测试 Doctor 端点

### 健康检查

```bash
curl http://localhost:8080/health
```

或者

```bash
curl http://localhost:8080/healthz
```

### 就绪检查

```bash
curl http://localhost:8080/ready
```

或者

```bash
curl http://localhost:8080/readyz
```

## 启用 pprof 性能分析（可选）

如果需要启用 pprof 进行性能分析，修改 `docker-compose.yml` 第 75 行：

```yaml
- DOCTOR_PPROF=true  # 改为 true
```

然后重启服务：

```bash
docker-compose up -d --build wisefido-data
```

⚠️ **注意**：生产环境建议保持 `DOCTOR_PPROF=false`

## 配置说明

- `DOCTOR_ENABLED=true` - Doctor 功能已启用（默认）
- `DOCTOR_PPROF=false` - pprof 默认禁用（生产环境推荐）

## 可用的 Doctor 端点

- `GET /health` 或 `/healthz` - 健康检查（检查 Redis、数据库连接）
- `GET /ready` 或 `/readyz` - 就绪检查（用于 Kubernetes）
- `GET /debug/pprof/*` - pprof 性能分析（需要 `DOCTOR_PPROF=true`）

